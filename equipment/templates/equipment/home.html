{% extends 'base.html' %}
{% load static %}

{% block title %}Home - Tudulu{% endblock %}

{% block content %}
<style>
    .jumbotron {
        background: linear-gradient(135deg, #4CAF50, #3e7cb1);
        color: white;
        border-radius: 12px;
        padding: 2rem;
    }
    .welcome-user {
        display: flex;
        align-items: center;
        gap: 15px;
        flex-wrap: wrap;
    }
    .welcome-user img {
        height: 55px;
        width: 55px;
        border-radius: 50%;
        object-fit: cover;
        border: 2px solid white;
        box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    .card {
        border: none;
        border-radius: 10px;
        overflow: hidden;
    }
    .card-title {
        color: #1e3d59;
    }
    .btn-primary {
        background-color: #3e7cb1;
        border-color: #3e7cb1;
    }
    .btn-primary:hover {
        background-color: #2d5f87;
        border-color: #2d5f87;
    }
    .quick-links a {
        text-decoration: none;
        color: #3e7cb1;
        font-weight: bold;
    }
    .quick-links a:hover {
        text-decoration: underline;
    }
    .stats-card {
        background-color: #f8fafc;
    }
</style>

<div class="container mt-4">
    <!-- Welcome Section -->
    <div class="jumbotron shadow-sm mb-4">
        <h1 class="display-5 mb-2">Welcome to Tudulu</h1>
        <p class="lead">Your trusted platform for medical equipment management and health information sharing.</p>

        {% if user.is_authenticated %}
        <div class="welcome-user">
            <img src="{% if user.profile.profile_picture %}{{ user.profile.profile_picture.url }}{% else %}{% static 'images/default_profile.png' %}{% endif %}"
                 alt="Profile picture">
            <p class="mb-0">
                Hello, <strong>{{ user.username }}</strong> ðŸ‘‹  
                <a href="{% url 'users:profile_edit' %}" class="btn btn-warning btn-sm ms-2">Edit Profile</a>
            </p>
        </div>
        {% else %}
            <p class="mb-0">Please <a href="{% url 'login' %}" class="text-light fw-bold">log in</a> to enjoy full features.</p>
        {% endif %}
    </div>

    <!-- Main Content -->
    <div class="row">
        <!-- Latest Posts -->
        <div class="col-lg-8">
            <h4 class="mb-3">ðŸ“° Latest Posts</h4>
            {% if posts %}
                {% for post in posts %}
                    <div class="card mb-3 shadow-sm">
                        <div class="card-body">
                            <h5 class="card-title">{{ post.title }}</h5>
                            <p class="card-text">{{ post.content|truncatewords:30 }}</p>
                            <small class="text-muted">
                                Posted by {{ post.author }} on {{ post.date_posted|date:"F j, Y" }}
                            </small>
                            <div class="mt-2">
                                <a href="{% url 'post_detail' post.id %}" class="btn btn-primary btn-sm">
                                    Read more
                                </a>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            {% else %}
                <p class="text-muted">No posts available at the moment.</p>
            {% endif %}
        </div>

        <!-- Sidebar -->
        <div class="col-lg-4">
            <!-- Quick Links -->
            <div class="card mb-3 shadow-sm quick-links">
                <div class="card-body">
                    <h5 class="card-title">ðŸ“Œ Quick Links</h5>
                    <ul class="list-unstyled mb-0">
                        <li><a href="{% url 'equipment:equipment_list' %}">View Equipment</a></li>
                        {% if user.is_authenticated %}
                            <li><a href="{% url 'equipment:add_equipment' %}">Add Equipment</a></li>
                            <li><a href="{% url 'equipment:create_post' %}">Create a Post</a></li>
                        {% else %}
                            <li><a href="{% url 'login' %}">Log in to manage equipment</a></li>
                        {% endif %}
                    </ul>
                </div>
            </div>

            <!-- Stats -->
            <div class="card shadow-sm stats-card">
                <div class="card-body">
                    <h5 class="card-title">ðŸ“Š Equipment Stats</h5>
                    <p>Total Equipment: {{ total_equipment }}</p>
                    <p>Recently Added: {{ recent_equipment }}</p>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
